<div data-th-fragment="comic_info_fragment" xmlns:shiro="http://www.thymeleaf.org/thymeleaf-extras-shiro">

    <!-- container -->
    <div class="container p-0" id="container">

        <!-- 操作按钮及数据筛选表单row -->
        <div class="row mt-5">
            <div class="col-2 offset-2 mt-4">
                <div class="btn-group float-left">
                    <button type="button"
                            class="btn btn-dark btn-twitter btn-sm"
                            @click="insertModalOpen" shiro:haspermission="insert">
                        <i class="fa fa-plus-circle"></i>&nbsp;&nbsp;添加
                    </button>
                    <button type="button"
                            class="btn btn-dark btn-twitter btn-sm"
                            @click="deleteBatch" shiro:haspermission="delete">
                        <i class='fa fa-trash'></i>&nbsp;&nbsp;删除
                    </button>
                </div>
            </div>
            <div class="col-8 mt-4">
                <form @submit.prevent="selectContent" id="selectForm">
                    <div class="input-group input-group-sm float-right">
                        <div class="input-group-prepend">
                            <span class="input-group-text">番剧名</span>
                        </div>
                        <input type="text" class="form-control" v-model.trim="selectFormData.comicName"/>
                        <div class="input-group-prepend">
                            <span class="input-group-text">状态</span>
                        </div>
                        <select class="custom-select" v-model="selectFormData.comicStatus">
                            <option value="" selected></option>
                            <option :value="item.dictVal" v-for="item in comicStatusDict">{{item.dictName}}</option>
                        </select>
                        <div class="input-group-prepend">
                            <span class="input-group-text">上架状态</span>
                        </div>
                        <select class="custom-select" v-model="selectFormData.comicShelfStatus">
                            <option value="" selected></option>
                            <option :value="item.dictVal" v-for="item in comicShelfStatusDict">{{item.dictName}}
                            </option>
                        </select>
                        <div class="input-group-prepend">
                            <span class="input-group-text">标签</span>
                        </div>
                        <select class="selectpicker" v-model="selectFormData.comicTag" multiple
                                data-selected-text-format="count > 100" data-size="5" data-actions-box="true"
                                title="请选择标签" data-width="160px">
                            <option :value="item.dictVal" v-for="item in comicLabelDict">{{item.dictName}}
                            </option>
                        </select>
                        <div class="input-group-append">
                            <button class="btn btn-dark btn-twitter btn-sm" type="submit">
                                <i class="fa fa-filter"></i>&nbsp;&nbsp;查询
                            </button>
                            <button class="btn btn-dark btn-twitter btn-sm" type="button"
                                    @click="clearSelectContent">
                                <i class="fa fa-eraser"></i>&nbsp;&nbsp;清空
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- 数据表格row -->
        <div class="row mt-3 r2">
            <div class="col-10 offset-2 c1">
                <table class="table table-dark table-borderless rounded bg-twitter" v-show="pageInfo != ''">
                    <thead>
                    <tr>
                        <td class="text-center"></td>
                        <td class="text-center font-size-14">图片</td>
                        <td class="text-center font-size-14" style="width:15%">番剧名</td>
                        <td class="text-center font-size-14" style="width:35%">简介</td>
                        <td class="text-center font-size-14" style="width:10%">状态</td>
                        <td class="text-center font-size-14" style="width:11%">标签</td>
                        <td class="text-center font-size-14" style="width:14%">时间</td>
                        <td class="text-center font-size-14" style="width:15%">管理</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr v-for="(item,index) in pageInfo.list" :key="index">
                        <td>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input"
                                       :id="'customCheck-'+ index" :value="item.id" v-model="ids"/>
                                <label class="custom-control-label" :for="'customCheck-'+ index"></label>
                            </div>
                        </td>
                        <td class="mask">
                            <img :src="item.comicImageUrl" class="table-cmimg rounded"/>
                            <a :href="item.comicLink" target="_blank">
                                <div class="mask-content"><i class="fa fa-play-circle-o fa-5x"></i><br/><br/><br/></div>
                            </a>
                        </td>
                        <td class="font-size-12 text-center align-middle">{{item.comicName}}<span
                                v-show="item.comicShelfStatus == 0">(已下架)</span></td>
                        <td class="font-size-12"><p class="table-cmcontent text-justify">{{item.comicContent |
                            cmContentFilter}}</p></td>
                        <td class="font-size-12 text-center align-middle">{{item.comicStatus |
                            cmStatusFilter(item.comicCurrentEpisodes)}}
                        </td>
                        <td class="font-size-12 text-center align-middle">{{item.comicLabel | cmLabelFilter}}</td>
                        <td class="font-size-12 text-center align-middle">{{item.comicTime}}</td>
                        <td class="text-center align-middle">
                            <button type="button" class="btn btn-warning btn-sm font-size-14 text-light"
                                    @click="detailModalOpen(item.id)">
                                <i class="fa fa-file-text-o"></i>&nbsp;&nbsp;详情
                            </button>
                            <br/><br/>
                            <button type="button" class="btn btn-info btn-sm font-size-14"
                                    @click="updateModalOpen(item.id)" shiro:haspermission="update">
                                <i class="fa fa-pencil-square-o"></i>&nbsp;&nbsp;修改
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <div class="d-flex align-items-center justify-content-center flex-row lead text-white font-size-14">
                    <span v-show="pageInfo == ''"><i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;查询不到数据</span>
                </div>
            </div>
        </div>

        <!-- 数据表格信息及分页row -->
        <div class="row mt-4 mb-5 r3">
            <div class="col-2 offset-2">
                <span class="badge badge-dark bg-twitter font-size-14"
                      v-text="'共' + pageInfo.pages + '页/' + pageInfo.total + '个'" v-show="pageInfo != ''"></span>
                <span class="badge badge-dark bg-twitter font-size-14" v-show="pageInfo == ''">共0页/0个</span>
            </div>
            <div class="col-8 c2">
                <nav v-show="pageInfo != ''">
                    <ul class="pagination float-right font-size-14">
                        <li class='page-item'>
                            <a class='page-link bg-twitter border-twitter text-white'
                               href='javascript:void(0)' v-show="!pageInfo.isFirstPage"
                               @click="toFirstPage">首页</a>
                        </li>
                        <li class='page-item'>
                            <a class='page-link bg-twitter border-twitter text-white'
                               href='javascript:void(0)' v-show="!pageInfo.isFirstPage"
                               @click="toPrePage">上一页</a>
                        </li>
                        <div v-for="item in pageInfo.navigatepageNums">
                            <li class='page-item active' v-if="pageInfo.pageNum == item">
                                <a class='page-link border-twitter'
                                   href='javascript:void(0)'>{{item}}</a>
                            </li>
                            <li class='page-item' v-else>
                                <a class='page-link bg-twitter border-twitter text-white'
                                   href='javascript:void(0)' @click="toClickPage(item)">{{item}}</a>
                            </li>
                        </div>
                        <li class='page-item'>
                            <a class='page-link bg-twitter border-twitter text-white'
                               href='javascript:void(0)' v-show="!pageInfo.isLastPage" @click="toNextPage">下一页</a>
                        </li>
                        <li class='page-item'>
                            <a class='page-link bg-twitter border-twitter text-white'
                               href='javascript:void(0)' v-show="!pageInfo.isLastPage"
                               @click="toLastPage(pageInfo.pages)">末页</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>

        <!-- 数据模态框 -->
        <div class="modal fade" id="dataModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <form @submit.prevent="submitContent">
                        <div class="modal-header">
                            <h5 class="modal-title">
                                <strong>{{modalTitle}}</strong>
                            </h5>
                            <button type="button" class="close" data-dismiss="modal">
                                <span><i class="fa fa-window-close text-white font-size-30"></i></span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group d-none">
                                <label class="col-form-label"> id：</label>
                                <input type="text" class="form-control form-control-sm" v-model="id"/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 番剧名：</label>
                                <input type="text" class="form-control form-control-sm" placeholder="请输入番剧名字"
                                       v-model.trim="comicName" :disabled="isDetailModal"/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 时间：</label>
                                <div class="input-group">
                                    <input type="text" class="form-control form-control-sm datepicker"
                                           placeholder="0000-00-00" v-model.trim="comicTime"
                                           :disabled="isDetailModal" ref="comicTime"/>
                                    <div class="input-group-append">
                                        <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 简介：</label>
                                <textarea class="form-control form-control-sm" placeholder="请输入简介" rows="6"
                                          v-model.trim="comicContent" :disabled="isDetailModal"></textarea>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 状态：</label>
                                <div class="custom-control custom-radio custom-control-inline"
                                     v-for="item in comicUpdtStatusDict">
                                    <input type="radio" :id="'comicUpdtStatus-'+ item.id"
                                           class="custom-control-input form-control-sm" :value="item.dictVal"
                                           v-model="comicStatus"
                                           :disabled="isDetailModal"/>
                                    <label class="custom-control-label font-size-14"
                                           :for="'comicUpdtStatus-'+ item.id">{{item.dictName}}</label>
                                </div>
                            </div>
                            <div class="form-group" v-show="isUdTimeShow">
                                <select class="form-control form-control-sm" v-model="comicUdTime"
                                        :disabled="isDetailModal">
                                    <option value="8" selected disabled>----请选择更新时间----</option>
                                    <option :value="item.dictVal" v-for="item in comicUpdtTimeDict">{{item.dictName}}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 当前话数：</label>
                                <input type="number" class="form-control form-control-sm" placeholder="请输入当前话数"
                                       v-model.number="comicCurrentEpisodes"
                                       :disabled="isDetailModal"/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 标签：</label><br/>
                                <div class="custom-control custom-checkbox custom-control-inline"
                                     v-for="item in comicLabelDict">
                                    <input type="checkbox" class="custom-control-input form-control-sm"
                                           :id="'comicTag-'+ item.id" :value="item.dictVal" v-model="comicTag"
                                           :disabled="isDetailModal"/>
                                    <label class="custom-control-label font-size-14" :for="'comicTag-'+ item.id">
                                        <i class="fa fa-tag"></i> {{item.dictName}}</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 自定义标签：</label>
                                <div class='row'>
                                    <input type="text" class="form-control form-control-sm col-2 ml-3"
                                           placeholder="标签一" v-model.trim="freeLabelA" :disabled="isDetailModal"/>
                                    <input type="text" class="form-control form-control-sm col-2 offset-1"
                                           placeholder="标签二" v-model.trim="freeLabelB" :disabled="isDetailModal"/>
                                    <input type="text" class="form-control form-control-sm col-2 offset-1"
                                           placeholder="标签三" v-model.trim="freeLabelC" :disabled="isDetailModal"/>
                                    <input type="text" class="form-control form-control-sm col-2 offset-1"
                                           placeholder="标签四" v-model.trim="freeLabelD" :disabled="isDetailModal"/>
                                </div>
                            </div>
                            <div class="form-group d-none">
                                <label class="col-form-label font-size-14"> 标签汇总：</label>
                                <input type="text" class="form-control form-control-sm" v-model="comicLabel"/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 上传图片：</label>
                                <div class="custom-file" v-show="!isDetailModal">
                                    <input type="file" class="custom-file-input form-control-sm"
                                           @change="cmImgFileChange" ref="cmImgFile"/>
                                    <label class="custom-file-label font-size-14">{{cmImgFileLb}}</label>
                                </div>
                                <br/> <br/>
                                <img :src="cmImgFilePv" class="rounded" width="25%"/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 观看地址：</label>
                                <input type="url" class="form-control form-control-sm" placeholder="请输入观看地址"
                                       v-model.trim="comicLink" :disabled="isDetailModal"/>
                            </div>
                            <div class="form-group">
                                <label class="col-form-label font-size-14"> 上架状态：</label>
                                <div class="custom-control custom-radio custom-control-inline"
                                     v-for="item in comicShelfStatusDict">
                                    <input type="radio" :id="'comicShelfStatus-'+ item.id"
                                           class="custom-control-input form-control-sm" :value="item.dictVal"
                                           v-model="comicShelfStatus" :disabled="isDetailModal"/>
                                    <label class="custom-control-label font-size-14"
                                           :for="'comicShelfStatus-'+ item.id">{{item.dictName}}</label>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-danger font-size-14" data-dismiss="modal">
                                <i class="fa fa-close"></i>&nbsp;&nbsp;关闭
                            </button>
                            <button type="submit" class="btn btn-primary font-size-14" v-show="!isDetailModal">
                                <i class="fa fa-check fa-lg"></i>&nbsp;&nbsp;提交
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div>

    <script src='/plugins/jquery.scrollUp.min.js'></script>
    <script src='/plugins/jquery.unveil.js'></script>
    <script src='/plugins/bootstrap-select.min.js'></script>
    <script src='/plugins/bootstrap-select.zh-CN.min.js'></script>
    <script type='module'>
        import {init, bootBox, datePicker, sysDict, imgVerificat} from '/common.js';

        new Vue({
            el: '#container',
            data: {
                selectFormData: {
                    comicName: '',
                    comicStatus: '',
                    comicShelfStatus: '',
                    comicTag: []
                },
                ids: [],
                nowPageNum: 1,
                pageInfo: '',
                modalTitle: '',
                isDetailModal: false,
                isUdTimeShow: false,
                id: 0,
                comicName: '',
                comicTime: '',
                comicContent: '',
                comicStatus: 0,
                comicUdTime: 8,
                comicCurrentEpisodes: 1,
                comicTag: [],
                freeLabelA: '',
                freeLabelB: '',
                freeLabelC: '',
                freeLabelD: '',
                cmImgFileLb: '示例图片.jpg',
                cmImgFilePv: '/images/tpjxz.jpg',
                comicLink: '',
                comicShelfStatus: 1,
                cmImgFileLbTmp: '',
                cmImgFilePvTmp: '',
                comicLabelDict: '',
                comicStatusDict: '',
                comicUpdtTimeDict: '',
                comicUpdtStatusDict: '',
                comicShelfStatusDict: ''
            },
            methods: {
                getPage() {
                    let sendData = this.selectFormData;
                    sendData.pageNum = this.nowPageNum;
                    sendData.pageSize = 10;
                    axios({
                        method: 'post',
                        url: '/comic/getPage',
                        headers: {
                            'Content-Type': 'application/json;charset=utf-8',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        data: JSON.stringify(sendData),
                        responseType: 'json'
                    }).then(res => {
                        if (res.data.code == 200) {
                            this.pageInfo = res.data.data;
                        } else if (res.data.code == 100) {
                            this.pageInfo = '';
                        } else if (res.data.code == 500) {
                            bootBox.alert(res.data.msg);
                        }
                    });
                },
                selectContent() {
                    this.nowPageNum = 1;
                    this.getPage();
                },
                clearSelectContent() {
                    $('#selectForm .filter-option-inner-inner').empty();
                    this.selectFormData.comicName = '';
                    this.selectFormData.comicStatus = '';
                    this.selectFormData.comicShelfStatus = '';
                    this.selectFormData.comicTag = [];
                    this.selectContent();
                },
                toFirstPage() {
                    this.nowPageNum = 1;
                    this.getPage();
                    this.scrollUp();
                },
                toPrePage() {
                    this.nowPageNum = this.nowPageNum - 1;
                    this.getPage();
                    this.scrollUp();
                },
                toNextPage() {
                    this.nowPageNum = this.nowPageNum + 1;
                    this.getPage();
                    this.scrollUp();
                },
                toLastPage(lastPage) {
                    this.nowPageNum = lastPage;
                    this.getPage();
                    this.scrollUp();
                },
                toClickPage(clickPage) {
                    this.nowPageNum = clickPage;
                    this.getPage();
                    this.scrollUp();
                },
                insertModalOpen() {
                    this.modalTitle = '『添加窗口』';
                    this.isDetailModal = false;
                    this.modalShow();
                },
                updateModalOpen(id) {
                    this.modalTitle = '『修改窗口』';
                    this.isDetailModal = false;
                    this.modalSetVal(id);
                },
                detailModalOpen(id) {
                    this.modalTitle = '『详情窗口』';
                    this.isDetailModal = true;
                    this.modalSetVal(id);
                },
                submitContent() {
                    if (this.comicName == '') {
                        toastr.warning('名称不能为空');
                    } else if (this.comicContent.length > 500) {
                        toastr.warning('简介不能超过500个字符');
                    } else {
                        let sendData = new FormData();
                        sendData.append('id', this.id);
                        sendData.append('comicName', this.comicName);
                        sendData.append('comicTime', this.comicTime);
                        sendData.append('comicContent', this.comicContent);
                        sendData.append('comicStatus', this.comicStatus);
                        sendData.append('comicUdTime', this.comicUdTime);
                        sendData.append('comicCurrentEpisodes', this.comicCurrentEpisodes);
                        sendData.append('comicLabel', this.comicLabel);
                        if (this.$refs.cmImgFile.value != '') {
                            sendData.append('cmImgFile', this.$refs.cmImgFile.files[0]);
                        }
                        sendData.append('comicLink', this.comicLink);
                        sendData.append('comicShelfStatus', this.comicShelfStatus);
                        let sendUrl = '';
                        if (this.id == 0) {
                            sendUrl = '/comic/insert';
                        } else {
                            sendUrl = '/comic/update';
                        }
                        axios({
                            method: 'post',
                            url: sendUrl,
                            headers: {
                                'X-Requested-With': 'XMLHttpRequest'
                            },
                            data: sendData,
                            responseType: 'json'
                        }).then(res => {
                            if (res.data.code == 200) {
                                toastr.success(res.data.msg);
                                if (this.id == 0) {
                                    this.clearSelectContent();
                                } else {
                                    this.getPage();
                                }
                                this.modalHide();
                            } else if (res.data.code == 100) {
                                toastr.error(res.data.msg);
                            } else if (res.data.code == 101) {
                                console.log(res.data.msg);
                            } else if (res.data.code == 500) {
                                bootBox.alert(res.data.msg);
                            }
                        });
                    }
                },
                deleteBatch() {
                    bootBox.confirm('确定要删除选中项吗？', () => {
                        if (this.ids.length == 0) {
                            toastr.warning('请至少选择一项删除');
                        } else {
                            let sendData = new FormData();
                            sendData.append('ids', this.ids);
                            axios({
                                method: 'post',
                                url: '/comic/deleteBatchByIds',
                                headers: {
                                    'X-Requested-With': 'XMLHttpRequest'
                                },
                                data: sendData,
                                responseType: 'json'
                            }).then(res => {
                                if (res.data.code == 200) {
                                    toastr.success(res.data.msg);
                                    this.ids = [];
                                    this.getPage();
                                } else if (res.data.code == 100) {
                                    toastr.error(res.data.msg);
                                } else if (res.data.code == 500) {
                                    bootBox.alert(res.data.msg);
                                }
                            });
                        }
                    });
                },
                modalSetVal(id) {
                    axios({
                        method: 'post',
                        url: '/comic/getById',
                        headers: {
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        params: {
                            id: id
                        },
                        responseType: 'json'
                    }).then(res => {
                        if (res.data.code == 200) {
                            this.id = res.data.data.id;
                            this.comicName = res.data.data.comicName;
                            this.comicTime = res.data.data.comicTime == null ? '' : res.data.data.comicTime;
                            this.comicContent = res.data.data.comicContent;
                            if (res.data.data.comicStatus == 0) {
                                this.comicStatus = 0;
                            } else {
                                this.comicStatus = 8;
                                this.comicUdTime = res.data.data.comicStatus;
                            }
                            this.comicCurrentEpisodes = res.data.data.comicCurrentEpisodes;
                            this.comicLabel = res.data.data.comicLabel;
                            let fileName = res.data.data.comicImageUrl;
                            let fileNewNameStart = fileName.lastIndexOf('/');
                            this.cmImgFileLb = fileName.substring(fileNewNameStart + 1);
                            this.cmImgFilePv = res.data.data.comicImageUrl;
                            this.comicLink = res.data.data.comicLink;
                            this.comicShelfStatus = res.data.data.comicShelfStatus;
                            this.cmImgFileLbTmp = fileName.substring(fileNewNameStart + 1);
                            this.cmImgFilePvTmp = res.data.data.comicImageUrl;
                            datePicker.setDate('.datepicker', res.data.data.comicTime);
                            this.modalShow();
                        } else if (res.data.code == 100) {
                            toastr.error(res.data.msg);
                        } else if (res.data.code == 500) {
                            bootBox.alert(res.data.msg);
                        }
                    });
                },
                datePickerBind() {
                    $('.datepicker').datepicker().on('hide', () => {
                        this.comicTime = this.$refs.comicTime.value;
                    });
                },
                cmImgFileChange(e) {
                    if (e.target.files.length != 0) {
                        let file = e.target.files[0];
                        let vfcRs = imgVerificat.confirm(file, 102400);
                        if (!vfcRs) {
                            if (this.id == 0) {
                                this.cmImgFileLb = '示例图片.jpg';
                                this.cmImgFilePv = '/images/tpjxz.jpg';
                            } else {
                                this.cmImgFileLb = this.cmImgFileLbTmp;
                                this.cmImgFilePv = this.cmImgFilePvTmp;
                            }
                            this.$refs.cmImgFile.value = '';
                        } else {
                            this.cmImgFileLb = file.name;
                            let reader = new FileReader();
                            reader.readAsDataURL(file);
                            reader.onload = e => {
                                this.cmImgFilePv = e.target.result;
                            }
                        }
                    } else {
                        if (this.id == 0) {
                            this.cmImgFileLb = '示例图片.jpg';
                            this.cmImgFilePv = '/images/tpjxz.jpg';
                        } else {
                            this.cmImgFileLb = this.cmImgFileLbTmp;
                            this.cmImgFilePv = this.cmImgFilePvTmp;
                        }
                    }
                },
                modalReset() {
                    $('#dataModal').on('hidden.bs.modal', () => {
                        this.id = 0;
                        this.comicName = '';
                        this.comicTime = '';
                        this.comicContent = '';
                        this.comicStatus = 0;
                        this.comicUdTime = 8;
                        this.comicCurrentEpisodes = 1;
                        this.comicTag = [];
                        this.freeLabelA = '';
                        this.freeLabelB = '';
                        this.freeLabelC = '';
                        this.freeLabelD = '';
                        this.cmImgFileLb = '示例图片.jpg';
                        this.cmImgFilePv = '/images/tpjxz.jpg';
                        this.comicLink = '';
                        this.comicShelfStatus = 1;
                        this.$refs.cmImgFile.value = '';
                        datePicker.clearDate('.datepicker');
                    });
                },
                modalShow() {
                    $('#dataModal').modal();
                },
                modalHide() {
                    $('#dataModal').modal('hide');
                },
                scrollUp() {
                    document.getElementById('scrollUp').click();
                },
                getSysDict() {
                    this.comicLabelDict = sysDict.get('comicLabel');
                    this.comicStatusDict = sysDict.get('comicStatus');
                    this.comicUpdtStatusDict = sysDict.get('comicUpdtStatus');
                    this.comicUpdtTimeDict = sysDict.get('comicUpdtTime');
                    this.comicShelfStatusDict = sysDict.get('comicShelfStatus');
                }
            },
            watch: {
                comicStatus(val) {
                    this.isUdTimeShow = val == 8;
                    if (val == 0) {
                        this.comicUdTime = 8;
                    }
                }
            },
            computed: {
                freeLabelArr: {
                    get() {
                        let tempFreeLabel = [];
                        tempFreeLabel.push(this.freeLabelA);
                        tempFreeLabel.push(this.freeLabelB);
                        tempFreeLabel.push(this.freeLabelC);
                        tempFreeLabel.push(this.freeLabelD);
                        return tempFreeLabel;
                    },
                    set(value) {
                        this.freeLabelA = value[0];
                        this.freeLabelB = value[1];
                        this.freeLabelC = value[2];
                        this.freeLabelD = value[3];
                    }
                },
                comicLabel: {
                    get() {
                        return this.comicTag.concat(this.freeLabelArr);
                    },
                    set(value) {
                        let labelArr = value.split(',');
                        this.comicTag = labelArr.slice(0, labelArr.length - 4);
                        let tempFreeLabel = [];
                        tempFreeLabel.push(labelArr[labelArr.length - 4]);
                        tempFreeLabel.push(labelArr[labelArr.length - 3]);
                        tempFreeLabel.push(labelArr[labelArr.length - 2]);
                        tempFreeLabel.push(labelArr[labelArr.length - 1]);
                        this.freeLabelArr = tempFreeLabel;
                    }
                }
            },
            mounted() {
                init.initToastr();
                init.initDatePicker('.datepicker');
                init.initScrollUp();
                init.initImgLazyLoad();
                this.datePickerBind();
                this.modalReset();
                this.getSysDict();
                this.getPage();
            }
        });

        Vue.filter('cmStatusFilter', function (status, currentEpisodes) {
            let arrCmStatus = ['已完结', '周一更新', '周二更新', '周三更新', '周四更新', '周五更新', '周六更新', '周日更新'
                , '更新中'];
            let res = '';
            arrCmStatus.forEach((cmStatus, index) => {
                if (status == 0) {
                    res = cmStatus + '：全' + currentEpisodes + '话';
                } else if (status == index) {
                    res = cmStatus + '：更新至第' + currentEpisodes + '话';
                }
            });
            return res;
        });

        Vue.filter('cmLabelFilter', function (value) {
            let arrCmLabel = (value).split(',');
            arrCmLabel = arrCmLabel.filter(label => label != '');
            return arrCmLabel.toString();
        });

        Vue.filter('cmContentFilter', function (value) {
            let subContent = value.substr(0, 200).trim();
            return subContent + '...';
        });
    </script>

    <style>
        @import '/plugins/bootstrap-select.min.css';

        /* 番剧图片 */
        .r2 .c1 .table-cmimg {
            width: 165px;
            height: 217px;
        }

        /* 番剧内容p */
        .r2 .c1 .table-cmcontent {
            line-height: 16px;
            height: 224px;
            overflow: hidden;
        }

        /* 番剧图片遮罩 */
        .r2 .c1 .mask {
            width: 165px;
            height: 217px;
            position: relative;
            cursor: pointer;
        }

        .r2 .c1 .mask .mask-content {
            width: 165px;
            height: 217px;
            background: black;
            position: absolute;
            bottom: 35px;
            left: 12px;
            display: none;
            font-size: 16px;
            color: white;
            text-align: center;
            padding-top: 68px;
            border-radius: .25rem;
        }

        .r2 .c1 .mask:hover .mask-content {
            width: 165px;
            height: 217px;
            background: rgba(0, 0, 0, 0.5);
            position: absolute;
            bottom: 35px;
            left: 12px;
            display: block;
            font-size: 16px;
            color: white;
            text-align: center;
            padding-top: 68px;
            border-radius: .25rem;
        }

        #selectForm .bootstrap-select > .dropdown-toggle.bs-placeholder, .bootstrap-select > .dropdown-toggle.bs-placeholder:active, .bootstrap-select > .dropdown-toggle.bs-placeholder:focus, .bootstrap-select > .dropdown-toggle.bs-placeholder:hover {
            height: 30px;
            font-size: 12px;
        }

        #selectForm .bootstrap-select .btn-light:not(:disabled):not(.disabled).active, .bootstrap-select .btn-light:not(:disabled):not(.disabled):active, .bootstrap-select .show > .btn-light.dropdown-toggle {
            height: 30px;
            font-size: 12px;
        }

        #selectForm .bootstrap-select .btn:not(:disabled):not(.disabled) {
            height: 30px;
            font-size: 12px;
        }

        #selectForm .bootstrap-select .dropdown-menu {
            font-size: 12px;
        }
    </style>

</div>